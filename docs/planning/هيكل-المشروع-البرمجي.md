> # هيكل المشروع البرمجي (Codebase Structure)

## 1. الهيكل العام
```
.
├── 01-التخطيط-الاستراتيجي/
├── 02-مراحل-التطوير/
├── 03-الوحدات-المتوازية/
├── 04-الأنظمة-المتقدمة/
├── 05-الدعم-والجودة/
├── src/
│   ├── api/                # واجهات برمجة التطبيقات الخارجية (Translation, STT)
│   ├── background/         # سكربتات الخلفية (Background Service Worker)
│   ├── content/            # سكربتات المحتوى (Content Scripts)
│   ├── core/               # النواة الأساسية (Audio Capture, Overlay Logic)
│   ├── hooks/              # خطاطيف React (Custom Hooks)
│   ├── options/            # صفحة الإعدادات (Options Page UI)
│   ├── popup/              # الواجهة المنبثقة (Popup UI)
│   ├── services/           # الخدمات الداخلية (Storage, Logging, Expert System)
│   ├── types/              # تعريفات الأنواع (TypeScript Interfaces)
│   └── utils/              # الدوال المساعدة (Helper Functions)
├── icons/                  # أيقونات الإضافة
├── manifest.json           # ملف تعريف الإضافة
└── package.json            # ملف إدارة التبعيات
```

## 2. وصف المكونات الرئيسية

| المكون | الوصف |
| :--- | :--- |
| **`src/background/`** | يدير حالة الإضافة، يستمع لأحداث المتصفح، ويقوم بالمهام طويلة الأمد (مثل معالجة الصوت). |
| **`src/content/`** | يتم حقنه في صفحات الويب، مسؤول عن التقاط الصوت، عرض التراكب (Overlay)، والتفاعل مع الفيديو. |
| **`src/core/`** | يحتوي على المنطق الأساسي لعملية الترجمة: التقاط الصوت، إرساله إلى STT، استقبال الترجمة، وإرسالها للعرض. |
| **`src/services/`** | يضم طبقة الخدمات التي تتعامل مع البيانات (التخزين)، الاتصال بالأنظمة الخارجية (نظام الخبراء)، ومعالجة الأخطاء. |
| **`manifest.json`** | ملف الإعدادات الأساسي الذي يحدد أذونات الإضافة، نقاط الدخول، والبيانات الوصفية. |

# هيكل المشروع البرمجي

يصف هذا المستند الهيكل البرمجي المقترح لأداة ترجمة الفيديو، موضحًا تنظيم المجلدات والملفات الرئيسية، وكيفية توزيع المكونات البرمجية داخل المشروع. يهدف إلى توفير دليل واضح للمطورين لضمان الاتساق وقابلية الصيانة.

## 1. أهداف هيكل المشروع:

*   توفير تنظيم منطقي للكود البرمجي.
*   تسهيل عملية التطوير والصيانة.
*   تحسين قابلية القراءة والفهم للمشروع.
*   دعم قابلية التوسع وإضافة ميزات جديدة بسهولة.
*   فصل الاهتمامات (Separation of Concerns) بين الوحدات والمكونات المختلفة.

## 2. الهيكل المقترح للمشروع:

```
/project-root
├── src/
│   ├── api/                  # واجهات برمجة التطبيقات (APIs) الخارجية والداخلية
│   │   ├── external/         # عملاء لخدمات API الخارجية (Google, DeepL, OpenAI)
│   │   ├── internal/         # واجهات API داخلية بين مكونات الأداة
│   │   └── types/            # تعريفات الأنواع (Types) الخاصة بالـ APIs
│   ├── assets/               # الأصول الثابتة (صور، أيقونات، خطوط)
│   │   ├── icons/            # أيقونات SVG أو PNG
│   │   ├── images/           # صور توضيحية أو خلفيات
│   │   └── fonts/            # ملفات الخطوط
│   ├── components/           # مكونات واجهة المستخدم القابلة لإعادة الاستخدام
│   │   ├── common/           # مكونات عامة (أزرار، مدخلات، قوائم)
│   │   ├── settings/         # مكونات خاصة بلوحة الإعدادات
│   │   ├── video-player/     # مكونات مشغل الفيديو
│   │   └── subtitles/        # مكونات عرض وتحرير الترجمات
│   ├── core/                 # النواة الأساسية للأداة والمنطق الرئيسي
│   │   ├── translation/      # منطق الترجمة، إدارة المحركات، نظام الخبراء
│   │   ├── stt-tts/          # منطق STT و TTS، إدارة المحركات الصوتية
│   │   ├── video-processing/ # معالجة الفيديو، مزامنة الصوت والنص
│   │   └── data-management/  # تخزين البيانات، المزامنة، إدارة المستخدم
│   ├── services/             # خدمات مساعدة (تسجيل الدخول، الإشعارات، التخزين)
│   │   ├── auth/             # خدمات المصادقة والترخيص
│   │   ├── storage/          # خدمات التخزين (محلي، سحابي)
│   │   ├── analytics/        # خدمات التحليلات وتتبع الاستخدام
│   │   └── notifications/    # خدمات الإشعارات
│   ├── utils/                # دوال مساعدة وأدوات عامة
│   │   ├── helpers.ts
│   │   ├── constants.ts
│   │   └── validators.ts
│   ├── types/                # تعريفات الأنواع (TypeScript) العامة والخاصة
│   │   ├── common.ts         # تعريفات الأنواع المشتركة (كما تم إنشاؤها)
│   │   ├── translation.ts    # أنواع خاصة بالترجمة
│   │   ├── stt-tts.ts        # أنواع خاصة بـ STT/TTS
│   │   └── ui.ts             # أنواع خاصة بواجهة المستخدم
│   ├── main.ts               # نقطة الدخول الرئيسية للتطبيق أو الإضافة
│   └── index.html            # ملف HTML الرئيسي (لواجهة المستخدم)
├── public/                   # الملفات العامة التي يتم تقديمها مباشرة (مثل index.html، manifest.json)
├── tests/                    # ملفات الاختبار (وحدة، تكامل، E2E)
│   ├── unit/                 # اختبارات الوحدات
│   ├── integration/          # اختبارات التكامل
│   └── e2e/                  # اختبارات النهاية إلى النهاية
├── docs/                     # وثائق المشروع (READMEs، أدلة المطورين)
├── config/                   # ملفات الإعدادات (بيئات، متغيرات)
├── .env                      # ملف متغيرات البيئة (غير مشمول في Git)
├── package.json              # تعريف المشروع والتبعيات
├── tsconfig.json             # إعدادات TypeScript
├── webpack.config.js         # إعدادات Webpack (إذا تم استخدامها)
└── README.md                 # وصف المشروع
```

## 3. شرح المجلدات الرئيسية:

*   **`src/`**: يحتوي على جميع الكود المصدري للتطبيق.
*   **`api/`**: ينظم التفاعلات مع الخدمات الخارجية والداخلية.
*   **`assets/`**: يخزن جميع الأصول غير البرمجية.
*   **`components/`**: يضم مكونات واجهة المستخدم القابلة لإعادة الاستخدام.
*   **`core/`**: يحتوي على المنطق الأساسي والمحركات الرئيسية للأداة.
*   **`services/`**: يوفر وظائف مساعدة لا ترتبط مباشرة بمنطق العمل الأساسي.
*   **`utils/`**: يضم الدوال والأدوات المساعدة العامة.
*   **`types/`**: يحدد جميع أنواع البيانات المستخدمة في المشروع لضمان السلامة الهيكلية.
*   **`public/`**: للملفات التي يتم تقديمها مباشرة دون معالجة بواسطة أداة البناء.
*   **`tests/`**: يحتوي على جميع الاختبارات لضمان جودة الكود.
*   **`docs/`**: مخصص لوثائق المشروع.
*   **`config/`**: لملفات الإعدادات الخاصة بالبيئات المختلفة.

## 4. التنفيذ التقني (Technical Implementation):

### التعريفات المطلوبة (Type Definitions):

*   يجب أن تعتمد جميع المكونات على التعريفات الموحدة الموجودة في `src/types/common.ts`.
*   قم بتوسيع هذه التعريفات حسب الحاجة لهذه المرحلة، مع إضافة أي أنواع جديدة ضرورية في ملفات أنواع مخصصة ضمن `src/types/`.

```typescript
// أمثلة على التعريفات التي يجب استخدامها/توسيعها من common.ts
import { ProjectConfig, ModuleConfig, ComponentConfig } from "../../types/common";

// تعريفات إضافية قد تكون مطلوبة في هذا النظام
export interface FileStructure {
  name: string;
  type: 'file' | 'directory';
  children?: FileStructure[];
}

export interface BuildConfiguration {
  entryPoint: string;
  outputPath: string;
  plugins: string[];
}
```

### قائمة التدقيق التقني (Technical Checklist):

*   تم إنشاء جميع المجلدات الرئيسية الموضحة في الهيكل.
*   تم توزيع الملفات البرمجية بشكل منطقي داخل هذا الهيكل.
*   تم تحديث ملفات `package.json` و `tsconfig.json` لتعكس الهيكل الجديد.
*   تم ضمان أن مسارات الاستيراد (import paths) تعمل بشكل صحيح.

**الناتج المطلوب:** هيكل مشروع برمجي منظم وواضح، يسهل على المطورين فهم المشروع والعمل عليه بكفاءة. **العدد الإجمالي للملفات البرمجية المتوقعة لهذه الوحدة يعتمد على حجم المشروع الكلي، ولكن الهيكل نفسه يتضمن عددًا محدودًا من ملفات التكوين الأساسية.**

---
