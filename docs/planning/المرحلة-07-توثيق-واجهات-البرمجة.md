# المرحلة 07: توثيق واجهات البرمجة (APIs)

تُعد هذه المرحلة حاسمة لضمان قابلية صيانة وتوسع أداة ترجمة الفيديو، حيث تركز على توثيق جميع واجهات برمجة التطبيقات (APIs)، سواء الداخلية أو الخارجية، بشكل شامل وواضح. يهدف هذا التوثيق إلى تمكين المطورين من فهم كيفية تفاعل المكونات المختلفة مع بعضها البعض، وكيفية استخدام الخدمات الخارجية بكفاءة.

## 1. أهمية توثيق واجهات البرمجة:

*   **قابلية الصيانة:** يسهل على المطورين الجدد فهم الكود وتعديله.
*   **قابلية التوسع:** يدعم إضافة ميزات جديدة أو دمج خدمات أخرى بسهولة.
*   **التعاون:** يتيح للفرق المختلفة العمل على أجزاء مختلفة من النظام دون تعارض.
*   **استكشاف الأخطاء وإصلاحها:** يسرع عملية تحديد المشكلات وحلها.

## 2. أنواع واجهات البرمجة المراد توثيقها:

### 2.1. واجهات برمجة التطبيقات الداخلية (Internal APIs):

هي الواجهات التي تستخدمها المكونات المختلفة داخل الأداة للتواصل فيما بينها. يجب أن يشمل التوثيق:

*   **`Translation API`:**
    *   **الوظائف:** `translateText()`, `detectLanguage()`, `getAvailableEngines()`, `getEngineConfig()`, `setEngineConfig()`, `addTranslationToArchive()`, `getTranslationFromArchive()`, `clearTranslationCache()`, `getTranslationStats()`.
    *   **المدخلات والمخرجات:** تحديد أنواع البيانات لكل وظيفة (مثل `TranslationRequest`, `TranslationResult`, `LanguageDetectionResult`, `TranslationEngineConfig`).
    *   **الأخطاء المحتملة:** وصف الأخطاء التي قد تحدث وكيفية التعامل معها.
    *   **أمثلة الاستخدام:** أمثلة عملية لاستدعاء الوظائف.
*   **`Audio API`:**
    *   **الوظائف:** `startCapture()`, `stopCapture()`, `processAudioSegment()`, `convertSpeechToText()`, `getAvailableSTTEngines()`, `getSTTEngineConfig()`, `setSTTEngineConfig()`, `getAudioStats()`.
    *   **المدخلات والمخرجات:** تحديد أنواع البيانات لكل وظيفة (مثل `AudioCaptureConfig`, `AudioSegment`, `STTResult`).
    *   **الأخطاء المحتملة:** وصف الأخطاء التي قد تحدث وكيفية التعامل معها.
    *   **أمثلة الاستخدام:** أمثلة عملية لاستدعاء الوظائف.
*   **`Storage API`:**
    *   **الوظائف:** `saveSettings()`, `loadSettings()`, `exportData()`, `importData()`, `clearData()`, `syncSettings()`, `getStorageStats()`.
    *   **المدخلات والمخرجات:** تحديد أنواع البيانات لكل وظيفة (مثل `AppConfig`, `DataExportFormat`, `SyncConfig`).
    *   **الأخطاء المحتملة:** وصف الأخطاء التي قد تحدث وكيفية التعامل معها.
    *   **أمثلة الاستخدام:** أمثلة عملية لاستدعاء الوظائف.
*   **`Messaging API`:**
    *   **الوظائف:** `sendMessage()`, `onMessage()`, `sendEvent()`, `onEvent()`, `getState()`, `setState()`.
    *   **المدخلات والمخرجات:** تحديد أنواع البيانات للرسائل والأحداث (مثل `MessagePayload`, `EventPayload`).
    *   **أمثلة الاستخدام:** أمثلة عملية لكيفية إرسال واستقبال الرسائل بين المكونات.

### 2.2. واجهات برمجة التطبيقات الخارجية (External APIs):

هي الواجهات التي توفرها خدمات خارجية وتتكامل معها الأداة (مثل خدمات الترجمة و STT السحابية). يجب أن يشمل التوثيق:

*   **Google Translate API:**
    *   **نقطة النهاية (Endpoint):** URL الخاص بالخدمة.
    *   **طريقة المصادقة (Authentication):** كيفية استخدام مفتاح API أو OAuth.
    *   **المدخلات والمخرجات:** تنسيق طلبات الترجمة والاستجابات.
    *   **حدود الاستخدام (Rate Limits):** قيود الاستخدام المفروضة على الخدمة.
    *   **الأخطاء المحتملة:** رموز الأخطاء الشائعة وكيفية التعامل معها.
*   **DeepL API:** (نفس التفاصيل المذكورة أعلاه)
*   **OpenAI Whisper API:** (نفس التفاصيل المذكورة أعلاه)
*   **خدمات التخزين السحابي (Google Drive, Dropbox):**
    *   **نقطة النهاية (Endpoint):** URL الخاص بالخدمة.
    *   **طريقة المصادقة (Authentication):** كيفية استخدام OAuth.
    *   **المدخلات والمخرجات:** تنسيق طلبات الرفع والتنزيل والاستجابات.
    *   **حدود الاستخدام (Rate Limits):** قيود الاستخدام المفروضة على الخدمة.
    *   **الأخطاء المحتملة:** رموز الأخطاء الشائعة وكيفية التعامل معها.

## 3. أدوات التوثيق (Documentation Tools):

*   **JSDoc/TSDoc:** لتوثيق الكود مباشرة ضمن الملفات المصدرية. (مستخلص من: `مرحلةتوثيقواجهاتالبرمجة(APIs).md`)
*   **Swagger/OpenAPI:** لتوثيق واجهات RESTful API (إذا كان هناك خادم مساعد). (مستخلص من: `مرحلةتوثيقواجهاتالبرمجة(APIs).md`)
*   **Markdown:** لكتابة الوثائق العامة والدلائل. (مستخلص من: `مرحلةتوثيقواجهاتالبرمجة(APIs).md`)

## 4. محتوى التوثيق:

يجب أن يتضمن توثيق كل API ما يلي:

*   **اسم الـ API:** اسم الواجهة أو الخدمة.
*   **الوصف:** شرح موجز لوظيفة الـ API.
*   **نقاط النهاية (Endpoints):** (للـ APIs الخارجية) عناوين URL للوصول إلى الخدمة.
*   **الطرق (Methods):** (للـ APIs الداخلية والخارجية) قائمة بالوظائف أو العمليات المتاحة.
*   **المعلمات (Parameters):** وصف لكل معلمة مطلوبة أو اختيارية، بما في ذلك نوعها ووصفها.
*   **الاستجابات (Responses):** وصف للاستجابات المتوقعة، بما في ذلك أنواع البيانات ورموز الحالة (Status Codes).
*   **الأمثلة (Examples):** أمثلة على طلبات الاستدعاء والاستجابات المتوقعة.
*   **الأخطاء (Errors):** قائمة بالأخطاء المحتملة وكيفية التعامل معها.
*   **المصادقة (Authentication):** (للـ APIs الخارجية) تفاصيل حول كيفية المصادقة على الخدمة.
*   **حدود الاستخدام (Rate Limits):** (للـ APIs الخارجية) أي قيود على عدد الطلبات.

## 5. التنفيذ التقني (Technical Implementation):

### التعريفات المطلوبة (Type Definitions):

*   يجب أن تعتمد جميع المكونات على التعريفات الموحدة الموجودة في `src/types/common.ts`. (مستخلص من: `مرحلةتوثيقواجهاتالبرمجة(APIs).md`)
*   قم بتوسيع هذه التعريفات حسب الحاجة لهذه المرحلة، مع إضافة أي أنواع جديدة ضرورية في ملفات أنواع مخصصة ضمن `src/types/`.

```typescript
// أمثلة على التعريفات التي يجب استخدامها/توسيعها من common.ts
import { APIKeyConfig } from "../../types/common";

// تعريفات إضافية قد تكون مطلوبة في هذه المرحلة
export interface APIEndpoint {
  url: string;
  method: "GET" | "POST" | "PUT" | "DELETE";
  description: string;
  parameters: any[];
  responses: any[];
}

export interface APIDocumentation {
  name: string;
  description: string;
  endpoints: APIEndpoint[];
  authentication: string;
}
```

### قائمة التدقيق التقني (Technical Checklist):

*   تم توثيق جميع واجهات برمجة التطبيقات الداخلية بشكل شامل.
*   تم توثيق جميع واجهات برمجة التطبيقات الخارجية المستخدمة بشكل شامل.
*   تم استخدام أدوات التوثيق المناسبة (JSDoc/TSDoc, Markdown).
*   التوثيق واضح، دقيق، وسهل الفهم للمطورين.
*   التوثيق يتضمن أمثلة عملية للاستخدام.
*   التوثيق يغطي الأخطاء المحتملة وكيفية التعامل معها.

**الناتج المطلوب:** مجموعة شاملة من ملفات التوثيق لواجهات برمجة التطبيقات، مكتوبة بتنسيق Markdown أو باستخدام JSDoc/TSDoc ضمن الكود. يجب أن تكون هذه الوثائق جزءًا لا يتجزأ من دليل المطور. **العدد الإجمالي للملفات المتوقعة لهذه المرحلة يتراوح بين 5 إلى 10 ملفات.**

---
