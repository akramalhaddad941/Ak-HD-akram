> # نظام الترجمة الذكي الشامل (Comprehensive Smart Translation System)

## 1. الوصف العام
يمثل هذا النظام النواة المركزية لوظيفة الترجمة في الأداة. وهو مسؤول عن تنسيق عملية الترجمة بأكملها، بدءًا من استقبال النص المعترف به من STT وصولاً إلى إرسال النص المترجم للعرض. يجمع النظام بين قوة محركات الترجمة المتعددة وتوجيهات نظام الخبراء لضمان أعلى جودة ودقة.

## 2. المكونات الرئيسية

| المكون | الوظيفة | التكامل مع الوحدات الأخرى |
| :--- | :--- | :--- |
| **وحدة الاستقبال والتوجيه** | تستقبل النص من نظام STT وتوجهه إلى وحدة اختيار المحرك الذكي. | نظام STT المتقدم |
| **وحدة اختيار المحرك الذكي** | تحدد محرك الترجمة الأمثل بناءً على معايير الأداء، التكلفة، وتوجيهات الخبير. | وحدة محركات الترجمة المتعددة، نظام إدارة الخبراء |
| **وحدة معالجة البرومبت (Prompt Processor)** | تقوم بإضافة البرومبتات المتخصصة (من نظام الخبراء) إلى النص المراد ترجمته قبل إرساله إلى محرك الترجمة. | نظام إدارة الخبراء |
| **وحدة التخزين المؤقت للترجمة** | تخزن أزواج النص المصدر والنص المترجم لتقليل زمن الاستجابة وتوفير تكاليف API. | وحدة محركات الترجمة المتعددة |
| **واجهة برمجة التطبيقات الموحدة للترجمة** | توفر نقطة اتصال واحدة لجميع المكونات التي تحتاج إلى خدمة الترجمة. | جميع الوحدات التي تحتاج للترجمة |

## 3. آلية العمل الذكية (Smart Workflow)

1.  **المدخل**: نص معترف به من STT.
2.  **التحقق من التخزين المؤقت**: هل تم ترجمة هذا النص مؤخرًا؟ إذا نعم، يتم إرجاع النتيجة فورًا.
3.  **تحليل السياق**: يتم تحليل النص لتحديد المجال التخصصي.
4.  **توجيه الخبير**: إذا كان السياق متخصصًا، يتم استدعاء الخبير المناسب للحصول على توجيهات (برومبت خاص).
5.  **اختيار المحرك**: يتم اختيار المحرك الأفضل.
6.  **التنفيذ**: يتم إرسال النص (مع البرومبت إذا لزم الأمر) إلى المحرك المختار.
7.  **المخرج**: نص مترجم عالي الجودة، يتم تخزينه مؤقتًا وإرساله للعرض.

# نظام الترجمة الذكي الشامل

يُعد نظام الترجمة الذكي الشامل هو القلب النابض لأداة ترجمة الفيديو، حيث يجمع بين محركات الترجمة المتعددة، آليات التحسين، والتعامل الذكي مع السياق لتقديم ترجمة عالية الجودة. يهدف هذا النظام إلى تجاوز الترجمة الآلية التقليدية من خلال دمج الذكاء الاصطناعي والتعلم الآلي لتقديم ترجمات أكثر دقة وسلاسة.

## 1. أهداف النظام:

*   توفير ترجمة آلية عالية الجودة للفيديوهات.
*   دعم محركات ترجمة متعددة (سحابية، مفتوحة المصدر، محلية).
*   تحسين جودة الترجمة من خلال معالجة السياق والتعلم من الأخطاء.
*   توفير خيارات تخصيص للمستخدم لاختيار المحرك المفضل وتفضيلات الترجمة.
*   دمج نظام الخبراء لتقديم ترجمات متخصصة ودقيقة.

## 2. المكونات الرئيسية:

### 2.1. مدير محركات الترجمة (Translation Engine Manager):

*   **`Engine Orchestrator`:** المكون المركزي الذي ينسق بين محركات الترجمة المختلفة، ويختار الأنسب بناءً على الإعدادات، اللغة، ونوع المحتوى. (مستخلص من: `المرحلةالثانيةتطويرالنواةالأساسية..md`, `الياتنظامالترجمةالشامل_251006_010449.md`)
*   **`Engine Adapters`:** واجهات موحدة للتعامل مع كل محرك ترجمة على حدة (مثل Google Translate, DeepL, LibreTranslate, NLLB). (مستخلص من: `مثالخطةتطويرلمحركاتالترجمة.md`)
*   **`APIKeyManager`:** لإدارة وتأمين مفاتيح API الخاصة بالمحركات السحابية. (مستخلص من: `مثالخطةتطويرلمحركاتالترجمة.md`)

### 2.2. معالج السياق والتحسين (Context & Enhancement Processor):

*   **`ContextualAnalyzer`:** لتحليل النص قبل الترجمة وتحديد السياق العام، المصطلحات المتخصصة، والكيانات المسماة. (مستخلص من: `الياتنظامالترجمةالشامل_251006_010449.md`)
*   **`GlossaryMatcher`:** لمطابقة المصطلحات في النص مع قواعد البيانات المصطلحية لضمان ترجمة متسقة ودقيقة. (مستخلص من: `المقصودبالخبراءفيهذاالسياق.md`)
*   **`TranslationMemoryMatcher`:** للبحث عن أجزاء من النص تم ترجمتها مسبقًا في ذاكرة الترجمة لإعادة استخدامها. (مستخلص من: `استراتيجياتالوصولوالترجمة.md`)
*   **`PostEditor`:** مكون يقوم بتحسين الترجمة الآلية بعد إنتاجها، باستخدام قواعد لغوية، نماذج تعلم آلي، أو تدخل بشري (اختياري). (مستخلص من: `الياتنظامالترجمةالشامل_251006_010449.md`)

### 2.3. نظام الخبراء المدمج (Integrated Expert System):

*   **`ExpertSystemIntegrator`:** يربط بين نظام الترجمة ومكونات نظام الخبراء لتقديم ترجمات متخصصة. (مستخلص من: `دمجمميزاتنظامالخبراءوالترجمةوsttكاملة.md`)
*   **`DomainSpecificTranslator`:** يستخدم نماذج تعلم آلي مدربة على مجالات محددة (مثل الطب، القانون) لتحسين الترجمة في تلك المجالات. (مستخلص من: `المقصودبالخبراءفيهذاالسياق.md`)
*   **`HumanReviewInterface`:** واجهة لتمكين خبراء الترجمة البشرية من مراجعة وتعديل الترجمات. (مستخلص من: `المقصودبالخبراءفيهذاالسياق.md`)

### 2.4. إدارة تفضيلات الترجمة (Translation Preferences Management):

*   **`UserPreferenceService`:** لتخزين واسترجاع تفضيلات المستخدم للترجمة (مثل المحرك المفضل، أسلوب الترجمة، اللغات المستهدفة). (مستخلص من: `اقسامالخياراتوالاعداداتالشاملة_251006_010036.md`)

## 3. تدفق عمل الترجمة (Translation Workflow):

1.  **استقبال النص:** يتم استقبال النص المراد ترجمته (سواء كان من STT أو من ملف ترجمة موجود). (مستخلص من: `الياتنظامالترجمةالشامل_251006_010449.md`)
2.  **التحليل المسبق:** يقوم `ContextualAnalyzer` بتحليل النص وتحديد المصطلحات والسياق. (مستخلص من: `الياتنظامالترجمةالشامل_251006_010449.md`)
3.  **البحث في الذاكرة والمصطلحات:** يتم البحث في `TranslationMemory` و `GlossaryManager` عن ترجمات موجودة. (مستخلص من: `الياتنظامالترجمةالشامل_251006_010449.md`)
4.  **اختيار المحرك:** يختار `Engine Orchestrator` المحرك الأنسب بناءً على الإعدادات المسبقة، توفر الترجمة في الذاكرة، أو طلب نظام الخبراء. (مستخلص من: `الياتنظامالترجمةالشامل_251006_010449.md`)
5.  **الترجمة الأولية:** يتم إرسال النص إلى المحرك المختار للحصول على ترجمة أولية. (مستخلص من: `الياتنظامالترجمةالشامل_251006_010449.md`)
6.  **المعالجة اللاحقة والتحسين:** يقوم `PostEditor` بتحسين الترجمة، وقد يتدخل نظام الخبراء لتقديم ترجمات متخصصة. (مستخلص من: `الياتنظامالترجمةالشامل_251006_010449.md`)
7.  **التخزين:** يتم تخزين الترجمة النهائية في `TranslationMemory` و `TranslationCache`. (مستخلص من: `الياتنظامالترجمةالشامل_251006_010449.md`)
8.  **إرجاع الترجمة:** يتم إرجاع الترجمة النهائية للعرض أو لمعالجتها بواسطة وحدة TTS. (مستخلص من: `الياتنظامالترجمةالشامل_251006_010449.md`)

## 4. التنفيذ التقني (Technical Implementation):

### التعريفات المطلوبة (Type Definitions):

*   يجب أن تعتمد جميع المكونات على التعريفات الموحدة الموجودة في `src/types/common.ts`.
*   قم بتوسيع هذه التعريفات حسب الحاجة لهذه المرحلة، مع إضافة أي أنواع جديدة ضرورية في ملفات أنواع مخصصة ضمن `src/types/`.

```typescript
// أمثلة على التعريفات التي يجب استخدامها/توسيعها من common.ts
import { TranslationRequest, TranslationResult, LanguageCode, EngineConfig } from "../../types/common";

// تعريفات إضافية قد تكون مطلوبة في هذا النظام
export interface SmartTranslationOptions {
  enginePriority: LanguageCode[];
  domainSpecific: boolean;
  useHumanReview: boolean;
}

export interface ContextAnalysisResult {
  keywords: string[];
  namedEntities: { type: string; value: string }[];
  domain: string;
}
```

### قائمة التدقيق التقني (Technical Checklist):

*   تم تصميم وتنفيذ `Engine Orchestrator` لإدارة محركات الترجمة.
*   تم تطوير محولات لدمج محركات ترجمة متعددة.
*   تم دمج مكونات `ContextualAnalyzer` و `GlossaryMatcher` و `TranslationMemoryMatcher`.
*   تم تنفيذ `PostEditor` لتحسين جودة الترجمة.
*   تم ربط النظام بنظام الخبراء لتقديم ترجمات متخصصة.
*   تم توفير واجهة لإدارة تفضيلات الترجمة.

**الناتج المطلوب:** نظام ترجمة ذكي وشامل قادر على تقديم ترجمات عالية الجودة، مرنة، وقابلة للتخصيص، مع دعم لمجموعة واسعة من محركات الترجمة. **العدد الإجمالي للملفات البرمجية المتوقعة لهذه الوحدة يتراوح بين 20 إلى 30 ملفًا.**

---
