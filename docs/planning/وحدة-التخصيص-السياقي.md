# وحدة التخصيص السياقي (Contextual Adaptation Unit)

تُعد وحدة التخصيص السياقي مكونًا متقدمًا في نظام STT، حيث تعمل على تحسين دقة التحويل النصي من خلال دمج المعلومات السياقية والمعرفية ذات الصلة بالمحتوى. تهدف هذه الوحدة إلى تجاوز الأخطاء الشائعة التي تحدث عندما لا يستطيع نموذج STT التمييز بين المصطلحات المتشابهة صوتيًا، خاصة في المجالات المتخصصة.

## الغرض والأهداف

*   **تحسين الدقة المصطلحية**: ضمان التعرف الصحيح على المصطلحات الفنية، الأسماء الخاصة، والكلمات المفتاحية المتعلقة بموضوع الفيديو.
*   **التكيف مع السياق**: تكييف النماذج اللغوية لمحركات STT لتفضيل الكلمات والعبارات الأكثر احتمالية في سياق معين (مثل المجال الطبي أو القانوني).
*   **التكامل المعرفي**: الربط بين نظام STT وقاعدة معارف المصطلحات ونظام إدارة الخبراء للاستفادة من البيانات المتخصصة.

## آلية العمل

1.  **تحديد السياق**: يتم تحليل المحتوى (عنوان الفيديو، الوصف، الكلمات المفتاحية المقدمة من المستخدم) لتحديد المجال والتخصص.
2.  **استخراج المصطلحات**: تتواصل الوحدة مع `قاعدة معارف المصطلحات.md` لاستخراج قائمة بالمصطلحات المتخصصة عالية الأهمية في السياق المحدد.
3.  **توجيه محرك STT**: يتم استخدام المصطلحات المستخرجة كـ "تلميحات" أو "تعزيزات" (Boosts) للنموذج اللغوي لمحرك STT. هذا يجعل النموذج يفضل هذه المصطلحات عند وجود تشابه صوتي.
    *   **مثال**: في السياق الطبي، عند سماع صوت يمكن أن يُفسر على أنه "Cell" أو "Sell"، يتم توجيه النموذج لتفضيل "Cell" (خلية) إذا كانت "خلية" ضمن قائمة المصطلحات الطبية المعززة.
4.  **المعالجة اللاحقة السياقية**: بعد التحويل النصي الأولي، يمكن للوحدة إجراء مراجعة سريعة للنص المكتوب، وتصحيح أي أخطاء واضحة تتعلق بالمصطلحات المتخصصة باستخدام قواعد سياقية.

## التنفيذ التقني (مثال)

```typescript
// src/services/contextualAdaptationUnit.ts
import { STTResult } from '../interfaces/sttEngine';
import { TerminologyService } from './terminologyService'; // Assume a service to access the terminology DB

export class ContextualAdaptationUnit {
  private terminologyService: TerminologyService;

  constructor() {
    // Initialize the terminology service (accessing the terminology DB)
    this.terminologyService = new TerminologyService();
  }

  async adapt(sttResult: STTResult, domain: string): Promise<STTResult> {
    console.log(`Applying contextual adaptation for domain: ${domain}`);

    // 1. Get domain-specific terminology
    const domainTerms = await this.terminologyService.getTermsForDomain(domain);

    let adaptedText = sttResult.text;

    // 2. Apply contextual correction (simplified example)
    // This step is usually done by passing the terminology list to the STT model itself
    // or by using a dedicated language model for post-correction.
    if (domain === 'medical') {
      // Example: Correcting a common STT error in the medical domain
      adaptedText = adaptedText.replace(/high blood pressure/gi, 'Hypertension');
    }

    // A more advanced approach would involve checking the confidence score of words
    // and replacing low-confidence words with a term from the domainTerms list if they are phonetically similar.

    return {
      ...sttResult,
      text: adaptedText,
      // The confidence score might be updated after correction
    };
  }
}

// Dummy Terminology Service for the example
class TerminologyService {
  async getTermsForDomain(domain: string): Promise<string[]> {
    if (domain === 'medical') {
      return ['Hypertension', 'Cardiology', 'Oncology', 'Diabetes'];
    }
    if (domain === 'legal') {
      return ['Jurisdiction', 'Plaintiff', 'Defendant', 'Statute'];
    }
    return [];
  }
}

export const contextualAdaptationUnit = new ContextualAdaptationUnit();
```

من خلال دمج المعرفة السياقية، تضمن وحدة التخصيص السياقي أن مخرجات STT ليست مجرد تحويل صوتي، بل هي تحويل نصي ذكي ومناسب للسياق، مما يقلل بشكل كبير من الأخطاء التي تتطلب تصحيحًا يدويًا.
